library(tidyverse)
library(tidyverse)
library(readxl)
censo_municipios_goias <- read_excel("01-dados/censo municipios goias.xlsx")
View(censo_municipios_goias)
library(tidyverse)
library(readxl)
censo_municipios_goias <- read_excel("01-dados/censo municipios goias.xlsx")
View(censo_municipios_goias)
#| echo: false
censo_municipios_goias[1,]
#| echo: false
censo_municipios_goias[1,3]
#| echo: false
censo_municipios_goias[1,3:7]
censo_municipios_goias[,1:23]
censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23)
censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio)
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio)
library(tidyverse)
library(readxl)
censo_municipios_goias <- read_excel("01-dados/censo municipios goias.xlsx")
View(censo_municipios_goias)
#| echo: false
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio)
View(faixa_masculino)
#| echo: false
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = gsub("H-",""))
#| echo: false
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate("faixa_etaria" = gsub("H-",""))
detach("package:stringr", unload = TRUE)
library(stringr)
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = gsub(faixa_etaria,"H-",""))
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23)
View(censo_municipios_goias)
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio)
View(faixa_masculino)
#| echo: false
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = sub(faixa_etaria,"H-",""))
masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = sub("H-","", faixa_etaria))
#| echo: false
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = sub("H-","", faixa_etaria))
#| echo: false
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = sub("H-","", faixa_etaria))
#| echo: false
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = str_sub(end = -2))
mutate(faixa_etaria = gsub("H-", "", faixa_etaria)
View(faixa_masculino)
View(faixa_masculino)
View(censo_municipios_goias)
faixa_feminino <- censo_municipios_goias[,c(1:2, 24:44)]
View(faixa_feminino)
faixa_feminino <- censo_municipios_goias[,c(1:2, 24:44)] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Feminino", .after = municipio)
faixa_feminino <- censo_municipios_goias[,c(1:2, 24:44)] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Feminino", .after = municipio)
mutate(faixa_etaria = gsub("M-", "", faixa_etaria))
faixa_feminino <- censo_municipios_goias[,c(1:2, 24:44)] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Feminino", .after = municipio) |>
mutate(faixa_etaria = gsub("M-", "", faixa_etaria))
View(faixa_feminino)
faixa_total <- rbind(faixa_feminino, faixa_masculino)
View(faixa_total)
# codigo para acessar dados de um datalake
dremio_host <- Sys.getenv("endereco")
dremio_port <- Sys.getenv("port")
dremio_uid <- Sys.getenv("uid")
dremio_pwd <- Sys.getenv("datalake")
channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;
HOST=%s;
PORT=%s;
UID=%s;
PWD=%s;
AUTHENTICATIONTYPE=Basic Authentication;
CONNECTIONTYPE=Direct",
dremio_host,
dremio_port,
dremio_uid,
dremio_pwd))
# codigo para acessar dados de um datalake
dremio_host <- Sys.getenv("endereco")
dremio_port <- Sys.getenv("port")
dremio_uid <- Sys.getenv("uid")
dremio_pwd <- Sys.getenv("datalake")
channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;
HOST=%s;
PORT=%s;
UID=%s;
PWD=%s;
AUTHENTICATIONTYPE=Basic Authentication;
CONNECTIONTYPE=Direct",
dremio_host,
dremio_port,
dremio_uid,
dremio_pwd))
# codigo para acessar dados de um datalake
dremio_host <- Sys.getenv("endereco")
dremio_port <- Sys.getenv("port")
dremio_uid <- Sys.getenv("uid")
dremio_pwd <- Sys.getenv("datalake")
channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;
HOST=%s;
PORT=%s;
UID=%s;
PWD=%s;
AUTHENTICATIONTYPE=Basic Authentication;
CONNECTIONTYPE=Direct",
dremio_host,
dremio_port,
dremio_uid,
dremio_pwd))
# codigo para acessar dados de um datalake
dremio_host <- Sys.getenv("endereco")
dremio_port <- Sys.getenv("port")
dremio_uid <- Sys.getenv("uid")
dremio_pwd <- Sys.getenv("datalake")
channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;
HOST=%s;
PORT=%s;
UID=%s;
PWD=%s;
AUTHENTICATIONTYPE=Basic Authentication;
CONNECTIONTYPE=Direct",
dremio_host,
dremio_port,
dremio_uid,
dremio_pwd))
library(RODBC)
# codigo para acessar dados de um datalake
dremio_host <- Sys.getenv("endereco")
dremio_port <- Sys.getenv("port")
dremio_uid <- Sys.getenv("uid")
dremio_pwd <- Sys.getenv("datalake")
channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;
HOST=%s;
PORT=%s;
UID=%s;
PWD=%s;
AUTHENTICATIONTYPE=Basic Authentication;
CONNECTIONTYPE=Direct",
dremio_host,
dremio_port,
dremio_uid,
dremio_pwd))
query <- 'SELECT * FROM "Open Analytics Layer".Profissionais."Quantidade de profissionais de saúde por município, na métrica da FTE" WHERE ano = "2024" and uf_sigla = "GO" and Categoria = "Médico"'
oferta <- sqlQuery(channel, query,
as.is = TRUE)
# codigo para acessar dados de um datalake
dremio_host <- Sys.getenv("endereco")
dremio_port <- Sys.getenv("port")
dremio_uid <- Sys.getenv("uid")
dremio_pwd <- Sys.getenv("datalake")
channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;
HOST=%s;
PORT=%s;
UID=%s;
PWD=%s;
AUTHENTICATIONTYPE=Basic Authentication;
CONNECTIONTYPE=Direct",
dremio_host,
dremio_port,
dremio_uid,
dremio_pwd))
query <- 'SELECT * FROM "Open Analytics Layer".Profissionais."'
medicos <- sqlQuery(channel, query,
as.is = TRUE)
# codigo para acessar dados de um datalake
dremio_host <- Sys.getenv("endereco")
dremio_port <- Sys.getenv("port")
dremio_uid <- Sys.getenv("uid")
dremio_pwd <- Sys.getenv("datalake")
channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;
HOST=%s;
PORT=%s;
UID=%s;
PWD=%s;
AUTHENTICATIONTYPE=Basic Authentication;
CONNECTIONTYPE=Direct",
dremio_host,
dremio_port,
dremio_uid,
dremio_pwd))
query <- 'SELECT * FROM "Open Analytics Layer".Profissionais."Quantidade de profissionais de saúde por município, na métrica da FTE" WHERE ano = "2024" and uf_sigla = "GO" and Categoria = "Médico"'
medicos <- sqlQuery(channel, query,
as.is = TRUE)
medicos_municipios <- medicos
# codigo para acessar dados de um datalake
dremio_host <- Sys.getenv("endereco")
dremio_port <- Sys.getenv("port")
dremio_uid <- Sys.getenv("uid")
dremio_pwd <- Sys.getenv("datalake")
channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;
HOST=%s;
PORT=%s;
UID=%s;
PWD=%s;
AUTHENTICATIONTYPE=Basic Authentication;
CONNECTIONTYPE=Direct",
dremio_host,
dremio_port,
dremio_uid,
dremio_pwd))
query <- 'SELECT * FROM "Open Analytics Layer".Profissionais."Quantidade de profissionais de saúde por município, na métrica da FTE" WHERE ano = "2024" and uf_sigla = "GO" and Categoria = "Médico"'
medicos <- sqlQuery(channel, query, as.is = TRUE)
medicos_municipios <- medicos
# codigo para acessar dados de um datalake
dremio_host <- Sys.getenv("endereco")
dremio_port <- Sys.getenv("port")
dremio_uid <- Sys.getenv("uid")
dremio_pwd <- Sys.getenv("datalake")
channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;
HOST=%s;
PORT=%s;
UID=%s;
PWD=%s;
AUTHENTICATIONTYPE=Basic Authentication;
CONNECTIONTYPE=Direct",
dremio_host,
dremio_port,
dremio_uid,
dremio_pwd))
query <- 'SELECT * FROM "Open Analytics Layer".Profissionais."Quantidade de profissionais de saúde por município, na métrica da FTE"'
medicos <- sqlQuery(channel, query, as.is = TRUE)
View(medicos)
View(medicos)
medicos_municipios < medicos |>
filter(ano = "2024")
medicos_municipios < medicos |>
filter(ano == "2024")
medicos_municipios < medicos |>
filter(ano == "2024") |>
filter(uf_sigla == "GO") |>
filter(categoria == "Médico")
# codigo para acessar dados de um datalake
dremio_host <- Sys.getenv("endereco")
dremio_port <- Sys.getenv("port")
dremio_uid <- Sys.getenv("uid")
dremio_pwd <- Sys.getenv("datalake")
channel <- odbcDriverConnect(sprintf("DRIVER=Dremio Connector;
HOST=%s;
PORT=%s;
UID=%s;
PWD=%s;
AUTHENTICATIONTYPE=Basic Authentication;
CONNECTIONTYPE=Direct",
dremio_host,
dremio_port,
dremio_uid,
dremio_pwd))
query <- 'SELECT * FROM "Open Analytics Layer".Profissionais."Quantidade de profissionais de saúde por município, na métrica da FTE"'
medicos2 <- sqlQuery(channel, query, as.is = TRUE)
medicos_municipios < medicos2 |>
filter(ano == "2024") |>
filter(uf_sigla == "GO") |>
filter(categoria == "Médico")
#| echo: false
# CONFIGURANDO BASE MASCULINO
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = gsub("H-", "", faixa_etaria)
# CONFIGURANDO BASE FEMININO
faixa_feminino <- censo_municipios_goias[,c(1:2, 24:44)] |>
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = gsub("H-", "", faixa_etaria)
library(tidyverse)
library(tidyverse)
library(readxl)
library(RODBC)
censo_municipios_goias <- read_excel("01-dados/censo municipios goias.xlsx")
library(tidyverse)
library(readxl)
library(RODBC)
censo_municipios_goias <- read_excel("01-dados/censo municipios goias.xlsx")
library(readxl)
censo_municipios_goias <- read_excel("01-dados/censo municipios goias.xlsx")
library(readxl)
censo_municipios_goias <- read_excel("01-dados/censo municipios goias.xlsx")
View(censo_municipios_goias)
#| echo: false
# CONFIGURANDO BASE MASCULINO
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = gsub("H-", "", faixa_etaria)
# CONFIGURANDO BASE FEMININO
faixa_feminino <- censo_municipios_goias[,c(1:2, 24:44)] |>
faixa_masculino <- censo_municipios_goias[,1:23] |>
gather(key = "faixa_etaria", value = "total", 3:23) |>
mutate(sexo = "Masculino", .after = municipio) |>
mutate(faixa_etaria = gsub("H-", "", faixa_etaria)
library(tidyverse)
library(tidyverse)
library(readxl)
library(RODBC)
censo_municipios_goias <- read_excel("01-dados/censo municipios goias.xlsx")
library(tidyverse)
library(readxl)
library(RODBC)
censo_municipios_goias <- read_excel("01-dados/censo municipios goias.xlsx")
library(tidyverse)
library(readxl)
library(RODBC)
censo_municipios_goias <- read_excel("01-dados/censo municipios goias.xlsx")
